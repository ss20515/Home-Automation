<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Home page</title>
     <link href="assets/css/bootstrap.css" rel="stylesheet" />
     <!-- FONTAWESOME STYLES-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
        <!-- CUSTOM STYLES-->
    <link href="assets/css/custom.css" rel="stylesheet" />
     <!-- GOOGLE FONTS-->
   <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.8.3/firebase.js"></script>
	<!--<script src="script.js"></script>-->
  <script src="firebase.js"></script>
  <script src="index.js"></script>
</head>
<body>


<div id="wrapper">

<!-- Navbar Top-->
        <div class="navbar navbar-inverse navbar-dark bg-dark navbar-fixed-top">
            <div class="adjust-nav">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">
                        <img src="assets/img/ha.jpeg" width="40px" height="40px">
                        

                    </a>
                    
                </div>
            </div>
        </div>
<!-- /Navabar Top-->






<!-- Navbar Side-->
        <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
                 


                   
                    <li class="active-link">
                        <a href="index.html" ><i class="fa fa-desktop "></i>Dashboard </a>
                    </li>

                     <!-- <li class="active-link">
                        <a href="index.html" ><i class="fa fa-bell-o "></i>Notifications </a>
                    </li> -->

                    <li class="active-link">
                        <a href="Analytics.html" ><i class="fa fa-circle-o-notch "></i>Analytics</a>
                    </li>

                   <!--  <li class="active-link">
                        <a href="index.html" ><i class="fa fa-gear "></i>Settings </a>
                    </li>
 -->
                    
                    <li class="active-link">
                        <a href="index.html" onclick="mainApp.logOut()" ><i class="fa fa-key "></i>Logout </a>
                    </li>

                   

                                     
                    
                </ul>
              </div>

        </nav>
<!-- /Navbar Side-->


<!-- Main Content Area-->
        <div id="page-wrapper" >
            <div id="page-inner">
                <div class="row">
                    <div class="col-lg-12">
                     <h2>Kitchen</h2>   
                    </div>
                </div>   




     <div class="buttonbox">
     <h1 class="Bulb"></h1>
  
     <button type="button" class="buttonone btn btn-primary btn-lg">Bulb</button>
     </div>



<script>

  var firebase = app_fireBase;

  $(document).ready(function(){
    var database = firebase.database();
    var bulb;
    var g,h,k,r1,r2;
    
    database.ref().on("value", function(snap){
      bulb = snap.val().led_k;
       g = snap.val().led_g;
      h = snap.val().led_h;
      k = snap.val().led_k;
      r1 = snap.val().led_r1cntrl;
      r2 = snap.val().led_r2cntrl;





      if(bulb == 1){
        $(".Bulb").text("Bulb is on.");
      } else {
        $(".Bulb").text("Bulb is off.");
      }
    });

    $(".buttonone").click(function(){
      var led_kRef = firebase.database().ref().child("led_k");
      if(bulb == 1){
        led_kRef.set(0);
        bulb = 0;

         var power = (g*1 + h*1 + k*0 + r1*1 + r2*1);

         var today = new Date();
        var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
        var datetime = time;

         // var ref = database.ref('timestamp');

        var data = {

          x: datetime,
          y:  power,
        }


       var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
        var theUrl = "https://automator1-be03e.firebaseio.com/timestamp.json";
        xmlhttp.open("POST", theUrl);
        xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xmlhttp.send(JSON.stringify(data));

        // ref.push(data);
      }else {
        led_kRef.set(1);
        bulb = 1;

         var power = (g*1 + h*1 + k*1 + r1*1 + r2*1);

         var today = new Date();
        var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
        var datetime = time;

         // var ref = database.ref('timestamp');

        var data = {

          x: datetime,
          y:  power,
        }

        var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
        var theUrl = "https://automator1-be03e.firebaseio.com/timestamp.json";
        xmlhttp.open("POST", theUrl);
        xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xmlhttp.send(JSON.stringify(data));

        // ref.push(data);
      }
    });
  });


</script>
     


<!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    <script src="assets/js/jquery-1.10.2.js"></script>
      <!-- BOOTSTRAP SCRIPTS -->
    <script src="assets/js/bootstrap.min.js"></script>
      <!-- CUSTOM SCRIPTS -->
    <script src="assets/js/custom.js"></script>

</body>
</html>